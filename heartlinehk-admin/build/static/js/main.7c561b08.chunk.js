(this["webpackJsonpheartlinehk-admin"]=this["webpackJsonpheartlinehk-admin"]||[]).push([[0],{35:function(e,t,n){},37:function(e,t,n){},39:function(e,t,n){},40:function(e,t,n){},49:function(e,t,n){},50:function(e,t,n){},51:function(e,t,n){},52:function(e,t,n){},53:function(e,t,n){},54:function(e,t,n){},55:function(e,t,n){},56:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n.n(r),s=n(28),o=n.n(s),c=(n(35),n(6)),i=n.n(c),l=n(10),u=n(7),d=n(16),m=n(8),f=(n(37),n(1)),b=function(e){return Object(f.jsx)("div",{id:e.modalId?e.modalId:"default-modal",className:"modal-container",children:Object(f.jsxs)("form",{className:"confirm-modal",children:[Object(f.jsx)("p",{className:"confirm-text",children:e.confirmText?e.confirmText:"Changes might be lost if you leave now. Confirm?"}),Object(f.jsx)("button",{type:"submit",name:"confirm-btn",className:"confirm-btn",onClick:e.formSubmitHandler,children:"\u78ba\u5b9a"}),Object(f.jsx)("button",{type:"submit",name:"cancel-btn",className:"cancel-btn",onClick:e.formSubmitHandler,children:"\u53d6\u6d88"})]})})},h=(n(39),function(e){return Object(f.jsx)("div",{id:e.modalId?e.modalId:"default-modal",className:"modal-container",children:Object(f.jsxs)("form",{className:"notice-modal",children:[Object(f.jsx)("p",{className:"notice-text",children:e.noticeText?e.noticeText:"Default Text for Notice Modal."}),Object(f.jsx)("button",{type:"submit",name:"confirm-btn",className:"confirm-btn",onClick:e.formSubmitHandler,children:"\u78ba\u5b9a"})]})})}),g=n.p+"static/media/logo_80x80.6314ce1a.png",v=(n(40),n(5)),p=(n(18),n(19),function(e){var t=Object(r.useRef)(),n=Object(r.useRef)(),a=Object(r.useState)(!1),s=Object(u.a)(a,2),o=s[0],c=s[1],i=function(){t.current.style.transitionDuration="0.5s",t.current.classList.remove("opened"),n.current.classList.remove("opened")};return Object(r.useEffect)((function(){v.a.database().ref("supervisors").child(e.currentUser.uid).once("value",(function(e){null!=e.val()?c(!0):c(!1)}))}),[]),Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{className:"nav-toggle-btn",onClick:function(){t.current.style.transitionDuration="0.5s",t.current.classList.add("opened"),n.current.classList.add("opened")},children:Object(f.jsx)("span",{className:"material-icons",children:"menu"})}),Object(f.jsxs)("nav",{className:"nav-container",ref:t,children:[Object(f.jsxs)("a",{href:"#",className:"nav-logo",children:[Object(f.jsx)("img",{src:g,alt:g,className:"front"}),Object(f.jsx)("p",{className:"nav-name",children:"HEARTLINEHK"})]}),Object(f.jsxs)("ul",{className:"nav-items-container",children:[Object(f.jsx)("li",{className:"nav-item",children:Object(f.jsxs)(d.b,{to:"/",className:"nav-link",onClick:i,children:[Object(f.jsx)("span",{className:"material-icons",children:"home"})," \u8cc7\u8a0a\u7248\u9762"]})}),Object(f.jsx)("li",{className:"nav-item",children:Object(f.jsxs)(d.b,{to:"/chatroom",className:"nav-link",onClick:i,children:[Object(f.jsx)("span",{className:"material-icons",children:"chat"})," \u804a\u5929\u5ba4"]})}),Object(f.jsx)("li",{className:"nav-item",children:Object(f.jsxs)(d.b,{to:"/profile-update",className:"nav-link",onClick:i,children:[Object(f.jsx)("span",{className:"material-icons",children:"badge"})," \u66f4\u6539\u500b\u4eba\u8cc7\u6599"]})}),o&&Object(f.jsx)("li",{className:"nav-item",children:Object(f.jsxs)(d.b,{to:"/supervisor",className:"nav-link",onClick:i,children:[Object(f.jsx)("span",{className:"material-icons",children:"question_answer"})," \u7ba1\u7406\u54e1\u7248\u9762"]})})]}),Object(f.jsxs)("div",{className:"nav-user",onClick:e.handleLogout,children:[Object(f.jsx)("img",{src:"https://t4.ftcdn.net/jpg/02/34/61/79/360_F_234617921_p1AGQkGyEl8CSzwuUI74ljn6IZXqMUf2.jpg",alt:""}),Object(f.jsx)("a",{className:"username",children:e.currentUser.displayName})]})]}),Object(f.jsx)("div",{ref:n,className:"nav-background",onClick:i})]})}),j=(n(49),function(e){var t=Object(r.useRef)(),n=function(){var n=Object(l.a)(i.a.mark((function n(r){var a;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r.preventDefault(),n.prev=1,!e.currentUser){n.next=14;break}if(""==(a=t.current.value)){n.next=11;break}return n.next=7,e.currentUser.updateProfile({displayName:a});case 7:t.current.value="",alert("Profile Update Successful!"),n.next=12;break;case 11:throw new Error("New Display Name is null!");case 12:n.next=15;break;case 14:throw new Error("Current User is null!");case 15:n.next=21;break;case 17:n.prev=17,n.t0=n.catch(1),console.error("ERROR: "+n.t0.message),alert(n.t0.message);case 21:case"end":return n.stop()}}),n,null,[[1,17]])})));return function(e){return n.apply(this,arguments)}}();return Object(f.jsx)("div",{className:"profile-update",children:Object(f.jsxs)("form",{className:"update-form",onSubmit:n,children:[Object(f.jsx)("label",{htmlFor:"display-name-input",children:"\u65b0\u986f\u793a\u540d\u7a31"}),Object(f.jsx)("input",{ref:t,type:"text",name:"display-name-input",id:"display-name-input"}),Object(f.jsx)("button",{type:"submit",children:"\u66f4\u6539\u8cc7\u6599"})]})})}),x=(n(50),function(e){var t={clientLeft:"\u4f7f\u7528\u8005\u5df2\u96e2\u958b\u804a\u5929\u5ba4",volunLeft:"\u7fa9\u5de5\u5df2\u96e2\u958b\u804a\u5929\u5ba4",clientId:"\u7fa9\u5de5\u5df2\u958b\u555f\u804a\u5929\u5ba4",noChatStarted:"\u6b64\u7fa9\u5de5\u672a\u6709\u958b\u555f\u804a\u5929\u5ba4"},n=v.a.database().ref("online_time"),a=v.a.database().ref("room_assigned"),s=v.a.database().ref("disconnect_time"),o=v.a.database().ref("chat_log"),c=Object(r.useRef)(null),d=Object(r.useState)(null),m=Object(u.a)(d,2),b=m[0],h=m[1],g=Object(r.useState)([]),p=Object(u.a)(g,2),j=p[0],x=p[1],O=Object(r.useState)([]),k=Object(u.a)(O,2),w=k[0],S=k[1],E=Object(r.useState)(!1),R=Object(u.a)(E,2),y=(R[0],R[1]),N=function(e){var t=[];if(console.log(e.val()),null!=e.val())for(var n in e.val())t.push({chatId:n,uid:e.val()[n].uid,time:e.val()[n].time,msg:e.val()[n].msg,spc:e.val()[n].spc});console.log(t),S(t)},I=function(e){var t=[];if(null!=e.val())for(var n in e.val())t.push(n);console.log(t),x(t)},C=function(e){h(e.val())},M=function(){var e=Object(l.a)(i.a.mark((function e(t){var n,r,c,l,u,d;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.target.innerHTML,r=null,e.next=4,a.once("value");case 4:c=e.sent.val(),e.t0=i.a.keys(c);case 6:if((e.t1=e.t0()).done){e.next=13;break}if(l=e.t1.value,c[l]!==n){e.next=11;break}return r=l,e.abrupt("break",13);case 11:e.next=6;break;case 13:console.log(n),console.log(r),u=sessionStorage.getItem("heartlinehk-supervisor-currentVolun"),d=sessionStorage.getItem("heartlinehk-supervisor-currentClient"),u&&o.child(u).orderByChild("time").off("value"),d&&s.child(d).off("value"),sessionStorage.setItem("heartlinehk-supervisor-currentVolun",n),sessionStorage.setItem("heartlinehk-supervisor-currentClient",r),h(null),null!=r?(o.child(n).orderByChild("time").on("value",N),s.child(r).on("value",C)):S([{chatId:"nochatstarted",uid:n,time:Date.now(),spc:"noChatStarted"}]);case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),U=function(e){var t=new Date(e),n=t.getHours()<10?"0"+t.getHours().toString():t.getHours().toString(),r=t.getMinutes()<10?"0"+t.getMinutes().toString():t.getMinutes().toString(),a=t.getMonth()<9?"0"+(t.getMonth()+1).toString():(t.getMonth()+1).toString();return n+":"+r+", "+(t.getDate()<10?"0"+t.getDate().toString():t.getDate().toString())+"/"+a};return Object(r.useEffect)((function(){return v.a.database().ref("supervisors").child(e.currentUser.uid).once("value",(function(e){null!=e.val()?y(!0):y(!1)})),n.on("value",I),function(){console.log("Supervisor Unmounted!"),n.off("value");var e=sessionStorage.getItem("heartlinehk-supervisor-currentVolun"),t=sessionStorage.getItem("heartlinehk-supervisor-currentClient");e&&(o.child(e).orderByChild("time").off("value"),sessionStorage.removeItem("heartlinehk-supervisor-currentVolun")),t&&(s.child(t).off("value"),sessionStorage.removeItem("heartlinehk-supervisor-currentClient"))}}),[]),Object(r.useEffect)((function(){w.length>0&&c.current.scrollTo(0,c.current.scrollHeight)}),[w]),Object(f.jsxs)("div",{className:"supervisor",children:[Object(f.jsx)("div",{className:"volunteers-container",children:j.map((function(e,t){var n=sessionStorage.getItem("heartlinehk-supervisor-currentVolun");return Object(f.jsx)("button",{className:"volun-btn"+(n===e?" selected":""),value:e,onClick:M,children:e},"online-volun-"+t)}))}),null!=b&&Object(f.jsxs)("p",{className:"disconnect-msg",children:["\u4f7f\u7528\u8005\u5df2\u65bc",U(b),"\u958b\u59cb\u96e2\u7dda\u3002"]}),Object(f.jsx)("div",{ref:c,className:"chat-container",children:w.length>0&&w.map((function(e,n){var r=sessionStorage.getItem("heartlinehk-supervisor-currentVolun");return Object(f.jsxs)("p",{className:"message "+(e.spc?"special":e.uid===r?"right":"left"),children:[e.msg?e.msg:t[e.spc]?t[e.spc]:t.clientId,Object(f.jsx)("span",{children:U(e.time)})]},e.chatId)}))})]})}),O=(n(51),function(){return Object(f.jsx)("div",{className:"loading",children:Object(f.jsx)("div",{className:"spinning-circle"})})}),k=(n(52),function(e){var t=Object(r.useState)([]),n=Object(u.a)(t,2),a=n[0],s=n[1];return Object(r.useEffect)((function(){s(e.dropdownOptions)}),[e.dropdownOptions]),Object(f.jsx)("div",{id:e.modalId?e.modalId:"default-modal",className:"modal-container",children:Object(f.jsxs)("form",{className:"dropdown-modal",children:[Object(f.jsx)("p",{className:"description-text",children:e.descriptionText?e.descriptionText:"Choose from the list below."}),Object(f.jsx)("select",{id:e.dropdownId?e.dropdownId:"default-dropdown-list",name:"dropdown-list",className:"dropdown-list",children:a.map((function(e,t){return Object(f.jsx)("option",{value:e,className:"dropdown-option",children:e},t)}))}),Object(f.jsx)("button",{type:"submit",name:"confirm-btn",className:"confirm-btn",onClick:e.formSubmitHandler,children:"\u78ba\u5b9a"}),Object(f.jsx)("button",{type:"submit",name:"cancel-btn",className:"cancel-btn",onClick:e.formSubmitHandler,children:"\u53d6\u6d88"})]})})}),w=n(30),S=n.n(w),E=(n(53),n.p+"static/media/pristine-609.9287f5ce.mp3"),R=function(e){var t={clientLeft:"\u4f7f\u7528\u8005\u5df2\u96e2\u958b\u804a\u5929\u5ba4",volunLeft:"\u7fa9\u5de5\u5df2\u96e2\u958b\u804a\u5929\u5ba4",clientId:"\u7fa9\u5de5\u5df2\u958b\u555f\u804a\u5929\u5ba4"},n=v.a.database().ref("online_time"),a=v.a.database().ref("chat_records"),s=v.a.database().ref("chat_queue"),o=v.a.database().ref("room_assigned"),c=v.a.database().ref("disconnect_time"),d=v.a.database().ref("typing_status"),m=v.a.database().ref("chat_log/".concat(e.currentUser.uid)),h=v.a.database().ref("transfer_requests/".concat(e.currentUser.uid)),g="https://docs.google.com/forms/d/e/1FAIpQLSdsD_qLU51OC9UY0Rrx_Ht52aU0TgPU-LUu5yNp4ta8cYu0yQ/viewform?usp=pp_url",p="entry.1533999842",j="entry.240218030",x="entry.1133078412",w=Object(r.useRef)(null),R=Object(r.useRef)(null),y=Object(r.useState)([]),N=Object(u.a)(y,2),I=N[0],C=N[1],M=Object(r.useState)(null),U=Object(u.a)(M,2),T=U[0],D=U[1],H=Object(r.useState)(null),L=Object(u.a)(H,2),q=L[0],A=L[1],_=Object(r.useState)([]),B=Object(u.a)(_,2),P=B[0],V=B[1],F=Object(r.useState)([]),Q=Object(u.a)(F,2),G=Q[0],z=Q[1],W=Object(r.useState)(null),Y=Object(u.a)(W,2),K=Y[0],J=Y[1],X=Object(r.useState)(!1),Z=Object(u.a)(X,2),$=Z[0],ee=Z[1],te=Object(r.useState)(!1),ne=Object(u.a)(te,2),re=ne[0],ae=ne[1],se=Object(r.useState)(!1),oe=Object(u.a)(se,2),ce=oe[0],ie=oe[1],le=Object(r.useState)(!1),ue=Object(u.a)(le,2),de=ue[0],me=ue[1],fe=Object(r.useState)(!1),be=Object(u.a)(fe,2),he=be[0],ge=be[1],ve=Object(r.useState)(!1),pe=Object(u.a)(ve,2),je=pe[0],xe=pe[1],Oe=Object(r.useState)(!1),ke=Object(u.a)(Oe,2),we=ke[0],Se=ke[1],Ee=Object(r.useState)(!1),Re=Object(u.a)(Ee,2),ye=Re[0],Ne=Re[1],Ie=function(e){var t=[];if(console.log(e.val()),null!=e.val())for(var n in e.val())t.push({chatId:n,uid:e.val()[n].uid,time:e.val()[n].time,msg:e.val()[n].msg,spc:e.val()[n].spc});console.log(t),V(t)},Ce=function(e){var t=[],n=!1,r=document.querySelectorAll(".chatroom .queue-container .clients-container .queue-client .client-id");if(console.log(e.val()),null!=e.val()){var a=function(a){if(t.push({userId:a,status:e.val()[a].status,time:e.val()[a].time}),!n){var s=!1;r.forEach((function(e){e.innerHTML===a&&(s=!0)})),n=!s}};for(var s in e.val())a(s);for(var o=0;o<t.length;o++)for(var c=0;c<t.length-o-1;c++)if(t[c].time>t[c+1].time){var i=t[c];t[c]=t[c+1],t[c+1]=i}}n&&new Audio(E).play();console.log(t),C(t)},Me=function(e){console.log(e.val()),null!=e.val()?"pending"===e.val().status&&J(e.val().from):J(null)},Ue=function(){var t=Object(l.a)(i.a.mark((function t(n){var r,a,s;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null==n.val()){t.next=40;break}if(r=sessionStorage.getItem("heartlinehk-targetVolun"),"accepted"!==n.val().status){t.next=33;break}if(null==r){t.next=30;break}return v.a.database().ref("transfer_requests/".concat(r)).onDisconnect().cancel(),t.next=7,m.once("value");case 7:return a=t.sent.val(),t.next=10,v.a.database().ref("chat_log/".concat(r)).set(a);case 10:return v.a.database().ref("transfer_requests/".concat(r)).off("value"),t.next=13,v.a.database().ref("transfer_requests/".concat(r)).remove();case 13:return sessionStorage.removeItem("heartlinehk-targetVolun"),t.next=16,m.remove();case 16:return V([]),t.next=19,d.child(e.currentUser.uid).remove();case 19:s=sessionStorage.getItem("heartlinehk-currentClient"),c.child(s).off("value"),A(null),d.child(s).off("value"),ge(!1),sessionStorage.removeItem("heartlinehk-currentClient"),D(null),Ne(!1),alert("\u8f49\u79fb\u5c0d\u8a71\u6210\u529f!"),t.next=31;break;case 30:console.error("ERROR: Target Volunteer ID is null!");case 31:t.next=40;break;case 33:if("rejected"!==n.val().status){t.next=40;break}return v.a.database().ref("transfer_requests/".concat(r)).onDisconnect().cancel(),t.next=37,v.a.database().ref("transfer_requests/".concat(r)).remove();case 37:sessionStorage.removeItem("heartlinehk-targetVolun"),Ne(!1),alert("\u8a72\u7fa9\u5de5\u5df2\u62d2\u7d55\u4e86\u4f60\u7684\u8f49\u79fb\u5c0d\u8a71\u8981\u6c42!");case 40:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Te=function(e){A(e.val())},De=function(e){ge(e.val())},He=function(){var t=Object(l.a)(i.a.mark((function t(){var n,r,a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,s.orderByChild("time").on("value",Ce),m.orderByChild("time").on("value",Ie),h.on("value",Me),n=sessionStorage.getItem("heartlinehk-currentClient"),t.next=7,o.once("value");case 7:r=t.sent,t.t0=i.a.keys(r.val());case 9:if((t.t1=t.t0()).done){t.next=17;break}if(a=t.t1.value,r.val()[a]!==e.currentUser.uid){t.next=15;break}return null!==n&&n!==a&&console.warn("WARNING: updating local current client as it is different from database!"),n=a,t.abrupt("break",17);case 15:t.next=9;break;case 17:null!=n?(c.child(n).on("value",Te),d.child(n).on("value",De),D(n),sessionStorage.setItem("heartlinehk-currentClient",n)):console.warn("WARNING: No client is assigned to the current volunteer!"),t.next=23;break;case 20:t.prev=20,t.t2=t.catch(0),console.error("ERROR: "+t.t2.message);case 23:case"end":return t.stop()}}),t,null,[[0,20]])})));return function(){return t.apply(this,arguments)}}(),Le=function(){var t=Object(l.a)(i.a.mark((function t(n){var r,a,l,u,f,b,h,g,p,j,x,O,k,w,S,E;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=0,a=null,l=null,t.prev=3,!$){t.next=6;break}throw new Error("Already starting a new chat!");case 6:if(ee(!0),s){t.next=12;break}throw ee(!1),new ReferenceError("Chat Queue reference not available!");case 12:if(o){t.next=17;break}throw ee(!1),new ReferenceError("Room Assigned reference not available!");case 17:if(m){t.next=22;break}throw ee(!1),new ReferenceError("Chat Room reference not available!");case 22:if(c){t.next=27;break}throw ee(!1),new ReferenceError("Disconnect Time reference not available!");case 27:if(d){t.next=32;break}throw ee(!1),new ReferenceError("Typing Status reference not available!");case 32:if(null==T){t.next=37;break}throw ee(!1),new Error("CurrentClient is already set!");case 37:return t.next=39,s.orderByChild("time").once("value");case 39:if(u=t.sent,f=[],null!=u.val()){for(b in u.val())f.push({userId:b,status:u.val()[b].status,time:u.val()[b].time});for(h=0;h<f.length;h++)for(g=0;g<f.length-h-1;g++)f[g].time>f[g+1].time&&(p=f[g],f[g]=f[g+1],f[g+1]=p)}t.t0=i.a.keys(f);case 43:if((t.t1=t.t0()).done){t.next=51;break}if(j=t.t1.value,"inQueue"!==f[j].status){t.next=49;break}return a=f[j].userId,l=f[j].time,t.abrupt("break",51);case 49:t.next=43;break;case 51:if(null!==a){t.next=54;break}throw ee(!1),new RangeError("No available client in chat queue!");case 54:return x=s.child(a),t.next=57,x.transaction((function(e){return null===e?void console.error("ERROR: Required Queue Client is Null!"):"roomAssigned"===e.status?void console.error("ERROR: Required Queue Client has already assigned a room!"):"inQueue"===e.status?{status:"roomAssigned",time:v.a.database.ServerValue.TIMESTAMP}:void console.error("Unknown Error!")}));case 57:if(!(O=t.sent).error){t.next=63;break}throw ee(!1),new Error(O.error);case 63:if(O.committed){t.next=66;break}throw ee(!1),new Error("Client Queue Transaction Aborted!");case 66:return r+=1,k=o.child(a),t.next=70,k.transaction((function(t){return null===t?e.currentUser.uid:void console.error("ERROR: Client to be assigned has a non-null volunteer ID!")}));case 70:if(!(w=t.sent).error){t.next=76;break}throw ee(!1),new Error(w.error);case 76:if(w.committed){t.next=79;break}throw ee(!1),new Error("Client Room Assigned Transaction Aborted!");case 79:return r+=1,t.next=82,m.once("value");case 82:if(null==t.sent.val()){t.next=86;break}return t.next=86,m.remove();case 86:return r+=1,t.next=89,m.push();case 89:return S=t.sent,t.next=92,S.transaction((function(t){return null===t?{uid:e.currentUser.uid,time:v.a.database.ServerValue.TIMESTAMP,spc:a}:void console.error("ERROR: Initial Message is not null!")}));case 92:if(!(E=t.sent).error){t.next=98;break}throw ee(!1),new Error(E.error);case 98:if(E.committed){t.next=101;break}throw ee(!1),new Error("Initial Message Transaction Aborted!");case 101:r+=1,sessionStorage.setItem("heartlinehk-currentClient",a),D(a),c.child(a).on("value",Te),d.child(a).on("value",De),ee(!1);case 107:t.next=120;break;case 109:if(t.prev=109,t.t2=t.catch(3),console.error("ERROR: "+t.t2.message),!(r>=1)){t.next=115;break}return t.next=115,s.child(a).set({status:"inQueue",time:l});case 115:if(!(r>=2)){t.next=118;break}return t.next=118,o.child(a).remove();case 118:r>=4&&(sessionStorage.setItem("heartlinehk-currentClient",a),D(a),ee(!1)),alert(t.t2.message);case 120:case"end":return t.stop()}}),t,null,[[3,109]])})));return function(e){return t.apply(this,arguments)}}(),qe=function(){var t=Object(l.a)(i.a.mark((function t(){var n,r,l,u,f,b,h,v,O,k,w,S,E,R,y,N,I,C,M,U,H,L,q,_,B,P,F,Q,G,z,W,Y;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=0,r=!1,l=0,u=0,t.prev=4,!re){t.next=7;break}throw new Error("Already ending a chat!");case 7:if(ae(!0),o){t.next=13;break}throw ae(!1),new ReferenceError("Room Assigned reference not available!");case 13:if(m){t.next=18;break}throw ae(!1),new ReferenceError("Chat Room reference not available!");case 18:if(c){t.next=23;break}throw ae(!1),new ReferenceError("Disconnect Time reference not available!");case 23:if(d){t.next=28;break}throw ae(!1),new ReferenceError("Typing Status reference not available!");case 28:if(a){t.next=33;break}throw ae(!1),new ReferenceError("Chat Records reference not available!");case 33:if(null!=T){t.next=38;break}throw ae(!1),new Error("Current Client is null!");case 38:return t.next=40,o.child(T).once("value");case 40:return f=t.sent,b=null===f.val(),t.next=44,m.once("value");case 44:if(h=t.sent.val(),v=!1,null==h){t.next=55;break}t.t0=i.a.keys(h);case 48:if((t.t1=t.t0()).done){t.next=55;break}if(O=t.t1.value,"clientLeft"!==h[O].spc){t.next=53;break}return v=!0,t.abrupt("break",55);case 53:t.next=48;break;case 55:return t.next=57,s.child(T).once("value");case 57:if(t.t2=t.sent.val(),k=null!=t.t2,console.log(b,v,k),n+=1,r=b||v){t.next=69;break}if(b){t.next=66;break}return t.next=66,o.child(T).set("volunLeft");case 66:if(!k){t.next=69;break}return t.next=69,s.child(T).remove();case 69:return n+=1,t.next=72,m.orderByChild("time").limitToFirst(1).once("value");case 72:for(S in w=t.sent.val())l=w[S].time;return u=Date.now(),t.next=77,m.transaction((function(e){return null!=e?null:void console.error("ERROR: Chat Log in Chatroom already null!")}));case 77:if(!(E=t.sent).error){t.next=83;break}throw ae(!1),new Error(E.error);case 83:if(E.committed){t.next=86;break}throw ae(!1),new Error("Chatrom Transaction Aborted!");case 86:return V([]),n+=1,t.next=90,a.push();case 90:return R=t.sent,t.next=93,R.set({uid:e.currentUser.uid,start:l,end:u});case 93:return t.next=95,d.child(e.currentUser.uid).remove();case 95:c.child(T).off("value"),A(null),d.child(T).off("value"),ge(!1),sessionStorage.removeItem("heartlinehk-currentClient"),D(null),ae(!1),y=new Date(l),N=y.getHours()<10?"0"+y.getHours().toString():y.getHours().toString(),I=y.getMinutes()<10?"0"+y.getMinutes().toString():y.getMinutes().toString(),C=new Date(u),M=C.getHours()<10?"0"+C.getHours().toString():C.getHours().toString(),U=C.getMinutes()<10?"0"+C.getMinutes().toString():C.getMinutes().toString(),H=C.getMonth()+1<10?"0"+(C.getMonth()+1).toString():(C.getMonth()+1).toString(),L=C.getDate()<10?"0"+C.getDate().toString():C.getDate().toString(),q=g+"&"+p+"="+C.getFullYear()+"-"+H+"-"+L+"&"+j+"="+N+":"+I+"&"+x+"="+M+":"+U,window.open(q,"ChatRecordForm","resizable=yes,scrollbars=yes,toolbar=yes,menubar=no,location=no,directories=no,status=yes");case 112:t.next=123;break;case 114:if(t.prev=114,t.t3=t.catch(4),console.error("ERROR: "+t.t3.message),!(n>=2)){t.next=121;break}if(r){t.next=121;break}return t.next=121,o.child(T).set(e.currentUser.uid);case 121:n>=3&&(c.child(T).off("value"),A(null),d.child(T).off("value"),ge(!1),sessionStorage.removeItem("heartlinehk-currentClient"),D(null),_=new Date(l),B=_.getHours()<10?"0"+_.getHours().toString():_.getHours().toString(),P=_.getMinutes()<10?"0"+_.getMinutes().toString():_.getMinutes().toString(),F=new Date(u),Q=F.getHours()<10?"0"+F.getHours().toString():F.getHours().toString(),G=F.getMinutes()<10?"0"+F.getMinutes().toString():F.getMinutes().toString(),z=F.getMonth()+1<10?"0"+(F.getMonth()+1).toString():(F.getMonth()+1).toString(),W=F.getDate()<10?"0"+F.getDate().toString():F.getDate().toString(),Y=g+"&"+p+"="+F.getFullYear()+"-"+z+"-"+W+"&"+j+"="+B+":"+P+"&"+x+"="+Q+":"+G,window.open(Y,"ChatRecordForm","resizable=yes,scrollbars=yes,toolbar=yes,menubar=no,location=no,directories=no,status=yes")),alert(t.t3.message);case 123:case"end":return t.stop()}}),t,null,[[4,114]])})));return function(){return t.apply(this,arguments)}}(),Ae=function(){var t=Object(l.a)(i.a.mark((function t(n){var r,a,s;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),t.prev=1,!ce){t.next=4;break}throw new Error("Already sending a message!");case 4:if(ie(!0),null!==T){t.next=8;break}throw ie(!1),new Error("Current Client is null!");case 8:if(null!==(r=document.getElementById("msg-input").value)&&""!==r){t.next=14;break}throw ie(!1),new Error("Message to be sent is empty!");case 14:if(m){t.next=19;break}throw ie(!1),new ReferenceError("Chatroom reference not available!");case 19:if(d){t.next=24;break}throw ie(!1),new ReferenceError("Typing Status reference not available!");case 24:return t.next=26,m.push();case 26:return a=t.sent,t.next=29,a.transaction((function(t){return null===t?{uid:e.currentUser.uid,time:v.a.database.ServerValue.TIMESTAMP,msg:r}:void console.error("ERROR: New Message is not null!")}));case 29:if(!(s=t.sent).error){t.next=35;break}throw ie(!1),new Error(s.error);case 35:if(s.committed){t.next=38;break}throw ie(!1),new Error("New Message Transaction Aborted!");case 38:return xe(!1),t.next=41,d.child(e.currentUser.uid).set(!1);case 41:document.getElementById("msg-input").value="",console.log("Message sent!"),ie(!1);case 44:t.next=50;break;case 46:t.prev=46,t.t0=t.catch(1),console.error("ERROR: "+t.t0.message),alert(t.t0.message);case 50:case"end":return t.stop()}}),t,null,[[1,46]])})));return function(e){return t.apply(this,arguments)}}(),_e=function(){var t=Object(l.a)(i.a.mark((function t(r){var a,s,c,l,u,d,m,f,b,h;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.preventDefault(),"transferchat-modal"!==(a=r.target.parentElement.parentElement).id){t.next=64;break}if(!("confirm-btn"===r.target.className)){t.next=61;break}if(s=!1,t.prev=6,c=document.getElementById("volun-dropdown-list"),l=c.value,u=sessionStorage.getItem("heartlinehk-currentClient"),!ye){t.next=12;break}throw new Error("Already Transferring a chat!");case 12:if(Ne(!0),s=!0,null!==l&&""!==l){t.next=19;break}throw Ne(!1),new Error("Target Volunteer is null!");case 19:if(null!==u){t.next=22;break}throw Ne(!1),new Error("Current Client is null!");case 22:return d=!1,t.next=25,n.once("value");case 25:return m=t.sent.val(),t.next=28,o.once("value");case 28:f=t.sent.val(),t.t0=i.a.keys(m);case 30:if((t.t1=t.t0()).done){t.next=46;break}if(t.t1.value!==l){t.next=44;break}b=!1,t.t2=i.a.keys(f);case 35:if((t.t3=t.t2()).done){t.next=42;break}if(h=t.t3.value,f[h]!==l){t.next=40;break}return b=!0,t.abrupt("break",42);case 40:t.next=35;break;case 42:return d=!b,t.abrupt("break",46);case 44:t.next=30;break;case 46:if(d){t.next=49;break}throw Ne(!1),new Error("Target Volunteer is either offline or chatting currently!");case 49:return t.next=51,v.a.database().ref("transfer_requests/".concat(l)).set({time:v.a.database.ServerValue.TIMESTAMP,from:e.currentUser.uid,client:u,status:"pending"});case 51:v.a.database().ref("transfer_requests/".concat(l)).onDisconnect().remove(),sessionStorage.setItem("heartlinehk-targetVolun",l),v.a.database().ref("transfer_requests/".concat(l)).on("value",Ue),t.next=61;break;case 56:t.prev=56,t.t4=t.catch(6),s&&Ne(!1),console.error("ERROR: "+t.t4.message),alert(t.t4.message);case 61:a.classList.remove("opened"),t.next=65;break;case 64:console.error("ERROR: Parent Element is not a transfer chat modal!");case 65:case"end":return t.stop()}}),t,null,[[6,56]])})));return function(e){return t.apply(this,arguments)}}(),Be=function(){var t=Object(l.a)(i.a.mark((function t(n){var r,a,s,l,u;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),"transferrequest-modal"!==(r=n.target.parentElement.parentElement).id){t.next=52;break}if(!("confirm-btn"===n.target.className)){t.next=46;break}return t.prev=5,t.next=8,h.once("value");case 8:if(null!==(a=t.sent.val())){t.next=11;break}throw new Error("No Transfer Request!");case 11:return s=a.client,l=a.from,console.log("Client: "+s),console.log("Target Volun: "+l),t.next=17,h.child("status").transaction((function(e){return"pending"===e?"accepted":void console.error("ERROR: Old Status of the transfer request is not pending!")}));case 17:if(!(u=t.sent).error){t.next=22;break}throw new Error(u.error);case 22:if(u.committed){t.next=24;break}throw new Error("Transfer Request Status Transaction Aborted!");case 24:return t.next=26,o.child(s).once("value");case 26:if(t.sent.val()==l){t.next=31;break}throw new Error("Old assigned volunteer is not the same as transfer initiator!");case 31:return t.next=33,o.child(s).set(e.currentUser.uid);case 33:sessionStorage.setItem("heartlinehk-currentClient",s),D(s),c.child(s).on("value",Te),d.child(s).on("value",De),alert("\u5c0d\u8a71\u8f49\u79fb\u5b8c\u6210!"),t.next=44;break;case 40:t.prev=40,t.t0=t.catch(5),console.error("ERROR: "+t.t0.message),alert(t.t0.message);case 44:t.next=48;break;case 46:return t.next=48,h.child("status").set("rejected");case 48:J(null),r.classList.remove("opened"),t.next=53;break;case 52:console.error("ERROR: Parent Element is not a transfer request modal!");case 53:case"end":return t.stop()}}),t,null,[[5,40]])})));return function(e){return t.apply(this,arguments)}}(),Pe=function(e){var t=e.target.innerHTML;console.log(t);var n=document.querySelector(".chatroom .chat-container .input-container #msg-input"),r=n.value.substring(0,n.selectionStart),a=n.value.substring(n.selectionEnd,n.value.length);0===n.selectionStart&&0===n.selectionEnd&&(r=n.value,a=""),n.value=r+t+a,n.focus(),n.setSelectionRange(r.length+1,r.length+1)},Ve=function(){me(!de),document.querySelector(".chatroom").classList.toggle("queue-opened")},Fe=function(){var t=Object(l.a)(i.a.mark((function t(){var r,a,s,c,l,u,d;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=document.getElementById("transferchat-modal"),t.next=3,n.once("value");case 3:return a=t.sent.val(),t.next=6,o.once("value");case 6:s=t.sent.val(),c=[],t.t0=i.a.keys(a);case 9:if((t.t1=t.t0()).done){t.next=24;break}if((l=t.t1.value)==e.currentUser.uid){t.next=22;break}u=!1,t.t2=i.a.keys(s);case 14:if((t.t3=t.t2()).done){t.next=21;break}if(d=t.t3.value,s[d]!=l){t.next=19;break}return u=!0,t.abrupt("break",21);case 19:t.next=14;break;case 21:u||c.push(l);case 22:t.next=9;break;case 24:console.log(c),z(c),r.classList.add("opened");case 27:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Qe=function(e){var t=parseFloat(getComputedStyle(document.documentElement).fontSize),n=document.querySelector(".chatroom .chat-container .special-char-container"),r="material-icons"===e.target.className?"arrow_back_ios"===e.target.innerHTML?"back-arrow":"forward-arrow":e.target.className;"back-arrow"===r?n.scrollBy(-(1.3*t+12),0):"forward-arrow"===r&&n.scrollBy(1.3*t+12,0)},Ge=function(e){var t=new Date(e),n=t.getHours()<10?"0"+t.getHours().toString():t.getHours().toString(),r=t.getMinutes()<10?"0"+t.getMinutes().toString():t.getMinutes().toString(),a=t.getMonth()<9?"0"+(t.getMonth()+1).toString():(t.getMonth()+1).toString();return n+":"+r+", "+(t.getDate()<10?"0"+t.getDate().toString():t.getDate().toString())+"/"+a};return Object(r.useEffect)((function(){return console.log("Chatroom mounted!"),He(),function(){console.log("Chatroom Unmounted!");var e=sessionStorage.getItem("heartlinehk-currentClient");s.orderByChild("time").off("value"),m.orderByChild("time").off("value"),h.off("value"),h.off("value"),e&&(c.child(e).off("value"),d.child(e).off("value"),sessionStorage.removeItem("heartlinehk-currentClient"))}}),[]),Object(r.useEffect)((function(){P.length>0&&w.current.scrollTo(0,w.current.scrollHeight)}),[P]),Object(r.useEffect)((function(){var e=document.getElementById("transferrequest-modal");K?e.classList.add("opened"):null!=e&&e.classList.remove("opened")}),[K]),Object(f.jsxs)("div",{className:"chatroom",children:[Object(f.jsx)(b,{modalId:"transferrequest-modal",confirmText:"\u7fa9\u5de5".concat(K,"\u5411\u4f60\u63d0\u51fa\u8f49\u79fb\u5c0d\u8a71\uff0c\u4f60\u63a5\u53d7\u55ce\uff1f"),formSubmitHandler:Be}),Object(f.jsx)(k,{modalId:"transferchat-modal",dropdownId:"volun-dropdown-list",descriptionText:"\u8acb\u9078\u64c7\u8981\u63a5\u624b\u5c0d\u8a71\u7684\u7fa9\u5de5\u3002",dropdownOptions:G,formSubmitHandler:_e}),Object(f.jsx)(b,{modalId:"endchat-modal",confirmText:"\u4f60\u78ba\u5b9a\u8981\u7d50\u675f\u5c0d\u8a71\u55ce\uff1f",formSubmitHandler:function(e){e.preventDefault();var t=e.target.parentElement.parentElement;"endchat-modal"===t.id?("confirm-btn"===e.target.className&&qe(),t.classList.remove("opened")):console.error("ERROR: Parent Element is not an end chat modal!")}}),Object(f.jsx)(b,{modalId:"startchat-modal",confirmText:"\u4f60\u78ba\u5b9a\u8981\u958b\u555f\u65b0\u5c0d\u8a71\u55ce\uff1f",formSubmitHandler:function(e){e.preventDefault();var t=e.target.parentElement.parentElement;"startchat-modal"===t.id?("confirm-btn"===e.target.className&&(Ve(),Le()),t.classList.remove("opened")):console.error("ERROR: Parent Element is not a start chat modal!")}}),($||re||ye)&&Object(f.jsx)(O,{}),Object(f.jsxs)("div",{className:"chat-container",children:[null!=q&&Object(f.jsxs)("p",{className:"disconnect-msg",children:["\u4f7f\u7528\u8005\u5df2\u65bc",Ge(q),"\u958b\u59cb\u96e2\u7dda\u3002"]}),Object(f.jsx)("div",{ref:w,className:"messages-container",children:P.map((function(n,r){var a=sessionStorage.getItem("heartlinehk-currentClient");return Object(f.jsxs)("p",{className:"message "+(n.spc?"special":null===a?n.uid===e.currentUser.uid?"right":"left":n.uid===a?"left":"right"),children:[n.msg?n.msg:t[n.spc]?t[n.spc]:t.clientId,Object(f.jsx)("span",{children:Ge(n.time)})]},n.chatId)}))}),Object(f.jsxs)("div",{className:"special-char-container",children:[Object(f.jsx)("button",{className:"back-arrow",onClick:Qe,children:Object(f.jsx)("span",{className:"material-icons",children:"arrow_back_ios"})}),["\u5572","\u5481","\u55f0","\u5497","\u55ba","\u4fc2","\u54cb","\u5514","\u54a9","\u54aa","\u5605","\u35ce","\u558e","\u5622","\u569f","\u56c9","\u4e5c","\u53fb","\u5462","\u5571","\u7747","\u8ad7","\u564f","\u5625","\u6652","\u548b","\u7793","\u551e","\u6c39","\u6530","\u4ffe","\u9582","\u5440","\u5566","\u51a7","\u664f","\u5b32","\u5587"].map((function(e,t){return Object(f.jsx)("button",{className:"spc-char",onClick:Pe,children:e},"spc-char"+t)})),Object(f.jsx)("button",{className:"forward-arrow",onClick:Qe,children:Object(f.jsx)("span",{className:"material-icons",children:"arrow_forward_ios"})})]}),Object(f.jsxs)("form",{className:"input-container",onSubmit:Ae,children:[he&&Object(f.jsx)("p",{className:"typing-msg",children:"\u4f7f\u7528\u8005\u6b63\u5728\u8f38\u5165..."}),Object(f.jsx)("button",{type:"button",name:"emoji-btn",id:"emoji-btn",onClick:function(){Se(!we)},children:Object(f.jsx)("span",{className:"material-icons",children:"emoji_emotions"})}),Object(f.jsx)("input",{type:"text",name:"msg-input",id:"msg-input",placeholder:"\u6309\u6b64\u5c0d\u8a71\u2026",onInput:function(t){if(T){var n=""!=t.target.value;n!=je&&(d?(xe(n),d.child(e.currentUser.uid).set(n)):console.error("ERROR: Typing Status reference not available!"))}}}),Object(f.jsx)("button",{type:"submit",name:"submit-btn",id:"submit-btn",children:Object(f.jsx)("span",{className:"material-icons",children:"send"})})]}),we&&Object(f.jsx)(S.a,{onEmojiClick:function(e,t){console.log(t.emoji);var n=document.querySelector(".chatroom .chat-container .input-container #msg-input"),r=n.value.substring(0,n.selectionStart),a=n.value.substring(n.selectionEnd,n.value.length);0===n.selectionStart&&0===n.selectionEnd&&(r=n.value,a=""),n.value=r+t.emoji+a,n.focus(),n.setSelectionRange(r.length+2,r.length+2)}})]}),Object(f.jsxs)("div",{className:"queue-container",children:[Object(f.jsxs)("p",{className:"main-text",children:[Object(f.jsx)("span",{className:"material-icons",children:"people"}),Object(f.jsx)("span",{className:"queue-count",children:I.length})]}),Object(f.jsx)("div",{ref:R,className:"clients-container",children:I.map((function(e,t){return Object(f.jsxs)("p",{className:"queue-client"+("roomAssigned"===e.status?" assigned":""),children:["Client ",Object(f.jsx)("span",{className:"client-id",children:e.userId}),Object(f.jsxs)("span",{className:"enqueue-time","data-time":e.time,children:["roomAssigned"===e.status?"\u88ab\u63a5\u6536":"\u5165\u968a","\u6642\u9593: ",Ge(e.time)]})]},e.userId)}))}),Object(f.jsxs)("div",{className:"buttons-container",children:[Object(f.jsx)("button",{type:"submit",name:"trasnsfer-btn",id:"transfer-btn",disabled:null==T,onClick:Fe,children:"\u8f49\u79fb\u5c0d\u8a71"}),Object(f.jsx)("button",{type:"submit",name:"start-btn",id:"start-btn",disabled:null!=T||I.length<=0,onClick:function(){document.getElementById("startchat-modal").classList.add("opened")},children:"\u958b\u59cb\u5c0d\u8a71"}),Object(f.jsx)("button",{type:"submit",name:"end-btn",id:"end-btn",disabled:null==T,onClick:function(){document.getElementById("endchat-modal").classList.add("opened")},children:"\u7d50\u675f\u5c0d\u8a71"})]})]}),Object(f.jsx)("button",{className:"queue-toggle",onClick:Ve,children:Object(f.jsx)("span",{className:"material-icons",children:de?"chat":"contacts"})})]})},y=(n(54),function(){return Object(f.jsx)("div",{className:"dashboard",children:Object(f.jsx)("h1",{children:"WORK IN PROGRESS"})})}),N=(n(55),function(e){return Object(f.jsxs)("div",{className:"login",children:[Object(f.jsx)("h1",{className:"main-text",children:"HeartlineHK Login"}),Object(f.jsxs)("form",{className:"login-form",onSubmit:e.handleLogin,children:[Object(f.jsx)("label",{htmlFor:"login-email",children:"Email:"}),Object(f.jsx)("input",{type:"email",name:"login-email",id:"login-email",required:!0}),Object(f.jsx)("label",{htmlFor:"login-pwd",children:"Password:"}),Object(f.jsx)("input",{type:"password",name:"login-password",id:"login-password",required:!0}),Object(f.jsx)("input",{type:"submit",value:"Login",name:"login-submit",id:"login-submit"})]})]})});var I=function(){var e=v.a.database().ref("online_time"),t=Object(r.useState)(null),n=Object(u.a)(t,2),a=n[0],s=n[1],o=Object(r.useState)(!1),c=Object(u.a)(o,2),g=c[0],O=c[1],k=Object(r.useState)(v.a.auth()),w=Object(u.a)(k,2),S=w[0],E=(w[1],function(){var t=Object(l.a)(i.a.mark((function t(n){var r,a,s;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!S.currentUser){t.next=27;break}if(!0!==n.val()){t.next=23;break}if(!e){t.next=20;break}return t.next=5,e.child(S.currentUser.uid).once("value");case 5:if(r=t.sent.val(),a=sessionStorage.getItem("heartlinehk-agentUid"),s=sessionStorage.getItem("heartlinehk-disconnected"),null!==r&&null!==s){t.next=17;break}return t.next=11,e.child(S.currentUser.uid).onDisconnect().remove();case 11:return t.next=13,e.child(S.currentUser.uid).set({uid:a,time:v.a.database.ServerValue.TIMESTAMP});case 13:e.child(S.currentUser.uid).off("value"),e.child(S.currentUser.uid).on("value",I),t.next=18;break;case 17:e.uid!=a&&(document.getElementById("auto-logout-modal").classList.add("opened"),M(!0));case 18:t.next=21;break;case 20:console.error("ERROR: Online Time Reference not availabl!");case 21:t.next=25;break;case 23:console.warn("WARNING: Current User is disconnected!"),sessionStorage.setItem("heartlinehk-disconnected",Date.now());case 25:t.next=28;break;case 27:console.error("ERROR: Current User is null!");case 28:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),I=function(e){null!=e.val()&&(e.val().uid!=sessionStorage.getItem("heartlinehk-agentUid")&&(document.getElementById("auto-logout-modal").classList.add("opened"),M(!0)))},C=function(){var e=Object(l.a)(i.a.mark((function e(t){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),g){e.next=20;break}return O(!0),n=document.getElementById("login-email").value,r=document.getElementById("login-password").value,e.prev=5,e.next=8,S.setPersistence(v.a.auth.Auth.Persistence.SESSION);case 8:return e.next=10,S.signInWithEmailAndPassword(n,r);case 10:console.log(S.currentUser),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(5),console.error(e.t0.message),alert(e.t0.message);case 17:O(!1),e.next=22;break;case 20:console.error("Already logging in"),alert("Already logging in!");case 22:case"end":return e.stop()}}),e,null,[[5,13]])})));return function(t){return e.apply(this,arguments)}}(),M=function(){var t=Object(l.a)(i.a.mark((function t(){var n,r=arguments;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=r.length>0&&void 0!==r[0]&&r[0],t.prev=1,e.child(S.currentUser.uid).off("value"),v.a.database().ref(".info/connected").off("value"),e.child(S.currentUser.uid).onDisconnect().cancel(),n){t.next=8;break}return t.next=8,e.child(S.currentUser.uid).remove();case 8:return t.next=10,S.signOut();case 10:console.log("Signed out!"),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(1),console.error(t.t0.message),alert(t.t0.message);case 17:case"end":return t.stop()}}),t,null,[[1,13]])})));return function(){return t.apply(this,arguments)}}();return Object(r.useEffect)((function(){return v.a.auth().onAuthStateChanged((function(e){e?(console.log("User is logged in!"),s(e),v.a.database().ref(".info/connected").off("value"),v.a.database().ref(".info/connected").on("value",E)):(sessionStorage.removeItem("heartlinehk-disconnected"),s(null))}))})),Object(r.useEffect)((function(){var e=function(){var e=.01*window.innerHeight;console.log(e),console.log(window.innerHeight),document.documentElement.style.setProperty("--vh","".concat(e,"px"))};sessionStorage.setItem("heartlinehk-agentUid",function(e){for(var t="",n=0,r=26,a=97,s=0;s<e;s++)r=0===(n=Math.floor(3*Math.random()))||1===n?26:10,a=0===n?97:1===n?65:48,t+=String.fromCharCode(Math.floor(Math.random()*r)+a);return t}(12)),e(),window.addEventListener("resize",e)}),[]),Object(f.jsx)(d.a,{children:Object(f.jsxs)("div",{className:"App",style:{width:"100vw",minHeight:"calc(100 * var(--vh, 1vh))",position:"relative",backgroundColor:"rgba(0,0,0,0.05)",display:"flex",flexDirection:"row",overflow:"hidden"},children:[Object(f.jsx)(h,{modalId:"auto-logout-modal",noticeText:"\u7531\u65bc\u6b64\u5e33\u865f\u5df2\u65bc\u53e6\u4e00\u88dd\u7f6e/\u8996\u7a97\u4e0a\u767b\u5165\uff0c\u6b64\u8996\u7a97\u5c07\u6703\u767b\u51fa\u5e33\u865f\u3002",formSubmitHandler:function(e){e.preventDefault();var t=e.target.parentElement.parentElement;"auto-logout-modal"===t.id?t.classList.remove("opened"):console.error("ERROR: Parent Element is not a logout modal!")}}),!a&&Object(f.jsx)(N,{handleLogin:C}),a&&Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(b,{modalId:"logout-modal",confirmText:"\u4f60\u78ba\u5b9a\u8981\u767b\u51fa\u55ce\uff1f",formSubmitHandler:function(e){e.preventDefault();var t=e.target.parentElement.parentElement;"logout-modal"===t.id?("confirm-btn"===e.target.className&&M(),t.classList.remove("opened")):console.error("ERROR: Parent Element is not a logout modal!")}}),Object(f.jsx)(p,{currentUser:a,handleLogout:function(){document.getElementById("logout-modal").classList.add("opened")}}),Object(f.jsxs)(m.c,{children:[Object(f.jsx)(m.a,{exact:!0,path:"/chatroom",children:Object(f.jsx)(R,{currentUser:a})}),Object(f.jsx)(m.a,{exact:!0,path:"/supervisor",children:Object(f.jsx)(x,{currentUser:a})}),Object(f.jsx)(m.a,{exact:!0,path:"/profile-update",children:Object(f.jsx)(j,{currentUser:a})}),Object(f.jsx)(m.a,{path:"/",children:Object(f.jsx)(y,{currentUser:a})})]})]})]})})};v.a.initializeApp({apiKey:"AIzaSyD-gB_LHwUq2qiUXdDt2CAxGCYQQla4hMo",authDomain:"heartlinehk-8e3ec.firebaseapp.com",databaseURL:"https://heartlinehk-8e3ec-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"heartlinehk-8e3ec",storageBucket:"heartlinehk-8e3ec.appspot.com",messagingSenderId:"1077537941035",appId:"1:1077537941035:web:f5b566fde9a2363a2d6c6e",measurementId:"G-S9JD41562T"}),o.a.render(Object(f.jsx)(a.a.StrictMode,{children:Object(f.jsx)(I,{})}),document.getElementById("root"))}},[[56,1,2]]]);
//# sourceMappingURL=main.7c561b08.chunk.js.map